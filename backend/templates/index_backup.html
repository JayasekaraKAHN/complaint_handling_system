<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Complaint Solution</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        /* Solution UI Styles - Inline Version */
        .complaint-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .complaint-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .complaint-icon {
            font-size: 2rem;
            margin-right: 15px;
        }

        .complaint-title h2 {
            color: #333;
            font-size: 1.5rem;
        }

        .complaint-title p {
            color: #666;
            font-size: 0.9rem;
        }

        .complaint-details {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .detail-item {
            display: flex;
            margin-bottom: 10px;
        }

        .detail-label {
            font-weight: 600;
            color: #555;
            min-width: 150px;
        }

        .detail-value {
            color: #333;
            flex: 1;
        }

        .solutions-container {
            display: grid;
            gap: 20px;
            margin-top: 30px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .solution-card {
            background: white;
            border-radius: 12px;
            padding: 0;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .solution-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .solution-card.primary {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #f8fff8 0%, #e8f5e8 100%);
        }

        .solution-card.alternate {
            border-color: #2196F3;
            background: linear-gradient(135deg, #f8fbff 0%, #e8f2fe 100%);
        }

        .solution-header {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .solution-type {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .solution-icon {
            font-size: 1.5rem;
        }

        .solution-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .primary .solution-title {
            color: #2e7d32;
        }

        .alternate .solution-title {
            color: #1565c0;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .solution-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .solution-checkbox.checked {
            background: #4CAF50;
            border-color: #4CAF50;
        }

        .solution-checkbox.checked::after {
            content: '‚úì';
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
        }

        .checkbox-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .solution-content {
            padding: 20px;
        }

        .solution-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .solution-steps {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .step-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .step-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .step-number {
            background: #4CAF50;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .alternate .step-number {
            background: #2196F3;
        }

        .step-text {
            color: #333;
            line-height: 1.5;
            flex: 1;
        }

        .actions-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .selected-solutions {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: left;
        }

        .selected-title {
            font-weight: 600;
            color: #1565c0;
            margin-bottom: 10px;
        }

        .selected-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .selected-item {
            padding: 8px 0;
            border-bottom: 1px solid #bbdefb;
            color: #333;
        }

        .selected-item:last-child {
            border-bottom: none;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #2196F3;
            color: white;
        }

        .btn-secondary:hover {
            background: #1976d2;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #666;
            color: #666;
        }

        .btn-outline:hover {
            background: #666;
            color: white;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .complaint-card {
                padding: 15px;
            }

            .solution-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .checkbox-container {
                align-self: flex-end;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <nav class="main-nav">
            <a href="/" class="nav-link active">üè† Home</a>
            <a href="/dashboard" class="nav-link">üìä MSISDN Dashboard</a>
            <a href="/msisdn_details" class="nav-link">üì± MSISDN Details</a>
        </nav>
        <h2>üîß Complaint Solution System</h2>
        <p class="subtitle">AI-powered complaint resolution using pattern analysis and Ollama LLM</p>

        <form id="complaintForm" method="post" action="/get_solution">
            <!-- Required Fields -->
            <div class="form-group">
                <label for="msisdn">MSISDN (Optional)</label>
                <input type="text" id="msisdn" name="msisdn" placeholder="Enter customer mobile number (optional)">
                <div class="field-description">Customer's mobile number</div>
            </div>

            <div class="form-group">
                <label for="complaint">Issue Description <span class="required">*</span></label>
                <textarea id="complaint" name="complaint" required
                    placeholder="Describe the issue or complaint in detail"></textarea>
                <div class="field-description">Brief description of the problem</div>
            </div>

            <!-- Technical Details Section -->
            <div class="section-header">üìã Technical Details</div>

            <div class="form-group">
                <label for="device_type_settings_vpn_apn">Device / Settings / VPN / APN</label>
                <input type="text" id="device_type_settings_vpn_apn" name="device_type_settings_vpn_apn"
                    placeholder="e.g., Android Phone, iPhone, Router, VPN settings">
                <div class="field-description">Device model, configuration, or network settings</div>
            </div>

            <div class="form-group">
                <label for="signal_strength">Signal Strength</label>
                <select id="signal_strength" name="signal_strength">
                    <option value="">Select signal strength</option>
                    <option value="Excellent">Excellent (4-5 bars)</option>
                    <option value="Good">Good (3-4 bars)</option>
                    <option value="Fair">Fair (2-3 bars)</option>
                    <option value="Weak">Weak (1-2 bars)</option>
                    <option value="No Signal">No Signal (0 bars)</option>
                </select>
                <div class="field-description">Current signal strength observed</div>
            </div>

            <div class="form-group">
                <label for="quality_of_signal">Quality of Signal</label>
                <select id="quality_of_signal" name="quality_of_signal">
                    <option value="">Select signal quality</option>
                    <option value="Clear">Clear - No issues</option>
                    <option value="Good">Good - Minor issues</option>
                    <option value="Fair">Fair - Some problems</option>
                    <option value="Poor">Poor - Frequent issues</option>
                    <option value="Intermittent">Intermittent - On/off problems</option>
                </select>
                <div class="field-description">Voice/data quality experienced</div>
            </div>

            <div class="form-group">
                <label for="site_kpi_alarm">Site KPI / Alarm</label>
                <input type="text" id="site_kpi_alarm" name="site_kpi_alarm"
                    placeholder="e.g., Site unavailability, KLPOR5, KLPET1, Cell outage">
                <div class="field-description">Any network alarms or site issues reported</div>
            </div>

            <div class="form-group">
                <label for="past_data_analysis">Past Data Analysis</label>
                <textarea id="past_data_analysis" name="past_data_analysis" rows="2"
                    placeholder="Previous similar issues, patterns, or analysis"></textarea>
                <div class="field-description">Historical context or previous troubleshooting</div>
            </div>

            <div class="form-group">
                <label for="indoor_outdoor_coverage_issue">Coverage Issue Type</label>
                <select id="indoor_outdoor_coverage_issue" name="indoor_outdoor_coverage_issue">
                    <option value="">Select coverage type</option>
                    <option value="Indoor">Indoor Coverage Issue</option>
                    <option value="Outdoor">Outdoor Coverage Issue</option>
                    <option value="Both">Both Indoor and Outdoor</option>
                    <option value="None">No Coverage Issue</option>
                </select>
                <div class="field-description">Where the issue occurs</div>
            </div>

            <!-- Location Information Section -->
            <div class="section-header">üìç Location Information</div>

            <div class="form-group">
                <label for="location">Location (Area/City)</label>
                <input type="text" id="location" name="location"
                    placeholder="e.g., Karachi, Lahore, Colombo, Downtown Area">
                <div class="field-description">General area or city name</div>
            </div>

            <div class="form-group">
                <label for="longitude">Longitude</label>
                <input type="number" id="longitude" name="longitude" step="any" placeholder="e.g., 67.0104">
                <div class="field-description">Precise longitude coordinate (if available)</div>
            </div>

            <div class="form-group">
                <label for="latitude">Latitude</label>
                <input type="number" id="latitude" name="latitude" step="any" placeholder="e.g., 24.8614">
                <div class="field-description">Precise latitude coordinate (if available)</div>
            </div>

            <button type="submit" id="submitBtn" class="submit-btn">üîç Get Solution</button>
        </form>

        <div id="solution" class="solution"></div>

        <!-- Inline Solutions Container -->
        <div id="inlineSolutionsContainer" style="display: none; margin-top: 30px;">
            
            <!-- Complaint Summary Card -->
            <div class="complaint-card" style="position: relative; z-index: 1;">
                <div class="complaint-header">
                    <div class="complaint-icon">üìã</div>
                    <div class="complaint-title">
                        <h2>üì± Complaint Analysis Results</h2>
                        <p id="complaintMeta">AI-generated solutions based on your complaint</p>
                    </div>
                    <span class="status-badge status-pending">Ready for Review</span>
                </div>
                
                <div class="complaint-details" id="complaintDetails">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <!-- Solutions Grid -->
            <div class="solutions-container" id="solutionsContainer">
                <!-- Solutions will be populated by JavaScript -->
            </div>

            <!-- Actions Panel -->
            <div class="actions-container">
                <div class="selected-solutions">
                    <div class="selected-title">Selected Solutions:</div>
                    <ul class="selected-list" id="selectedSolutionsList">
                        <li class="selected-item">No solutions selected yet</li>
                    </ul>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="submitSolutions()">
                        <span>‚úÖ</span> Submit Selected Solutions
                    </button>
                    <button class="btn btn-secondary" onclick="generateReport()">
                        <span>üìÑ</span> Generate Solution Report
                    </button>
                    <button class="btn btn-outline" onclick="resetSelections()">
                        <span>üîÑ</span> Reset Selections
                    </button>
                </div>
            </div>
        </div>

        <!-- Location Data Table -->
        <div>
            <h3>Location Data</h3>
            <table id="locationTable">
                <thead>
                    <tr>
                        <th>Site Name</th>
                        <th>RSRP Range 1 (> -105dBm)</th>
                        <th>RSRP Range 2 (-105 to -110dBm)</th>
                        <th>RSRP Range 3 (-110 to -115dBm)</th>
                        <th>RSRP Below -115dBm</th>
                        <th>Distance (km)</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will be populated here via JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="info-box">
            <h4>ü§ñ Smart Complaint Resolution Logic</h4>

            <ul>
                <li><strong>Exact Match:</strong> Same complaint + same conditions ‚Üí Returns exact solution from dataset
                    (max 5 sentences)</li>
                <li><strong>Pattern Analysis:</strong> Similar complaint + different conditions ‚Üí Analyzes historical
                    patterns</li>
                <li><strong>New Complaint:</strong> Completely new issue ‚Üí Uses Ollama Llama 3.2 1B LLM with full
                    context</li>
            </ul>

            <div class="pro-tips">
                <strong>üí° Tips:</strong><br>
                ‚Ä¢ Required field: Issue Description<br>
                ‚Ä¢ MSISDN is optional but helps provide more personalized solutions<br>
                ‚Ä¢ Fill only relevant optional fields for better matching<br>
                ‚Ä¢ System analyzes only provided information<br>
                ‚Ä¢ More details = better solution accuracy
            </div>
        </div>
    </div>

    <script>
        // Form submission with enhanced UX
        document.getElementById('complaintForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            const lat = document.getElementById('latitude').value;
            const lon = document.getElementById('longitude').value;
            submitBtn.innerHTML = 'üîÑ Analyzing...';
            submitBtn.disabled = true;

            // Get form values
            const formData = {
                msisdn: document.getElementById('msisdn').value,
                complaint: document.getElementById('complaint').value,
                device_type_settings_vpn_apn: document.getElementById('device_type_settings_vpn_apn').value || null,
                signal_strength: document.getElementById('signal_strength').value || null,
                quality_of_signal: document.getElementById('quality_of_signal').value || null,
                site_kpi_alarm: document.getElementById('site_kpi_alarm').value || null,
                past_data_analysis: document.getElementById('past_data_analysis').value || null,
                indoor_outdoor_coverage_issue: document.getElementById('indoor_outdoor_coverage_issue').value || null,
                location: document.getElementById('location').value || null,
                longitude: document.getElementById('longitude').value ? parseFloat(document.getElementById('longitude').value) : null,
                latitude: document.getElementById('latitude').value ? parseFloat(document.getElementById('latitude').value) : null
            };

            const solutionDiv = document.getElementById('solution');
            solutionDiv.className = 'solution';
            solutionDiv.innerHTML = '';

            try {
                // Show loading state
                solutionDiv.innerHTML = '<div class="loading">ü§ñ Analyzing complaint and generating solution...</div>';
                solutionDiv.className = 'solution show';

                const response = await fetch('/api/solution', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();

                if (data.solution) {
                    // Check if it's structured solution data
                    if (data.solution.primary && data.solution.alternatives) {
                        showInlineSolutions(data.solution, formData);
                    } else {
                        // Fallback to text display
                        const optionalFields = [
                            formData.device_type_settings_vpn_apn, formData.signal_strength, formData.quality_of_signal,
                            formData.site_kpi_alarm, formData.past_data_analysis, formData.indoor_outdoor_coverage_issue,
                            formData.location, formData.longitude, formData.latitude
                        ].filter(field => field !== null && field !== '').length;

                        const fieldInfo = optionalFields > 0 ?
                            `<div class="text-small text-muted mb-2">üìä Analyzed with ${optionalFields} additional field${optionalFields !== 1 ? 's' : ''}</div>` :
                            `<div class="text-small text-muted mb-2">üìä Basic analysis (required fields only)</div>`;

                        solutionDiv.innerHTML = fieldInfo + `<strong>üîß Solution:</strong><br><br>${data.solution}`;
                    }
                } else if (data.error) {
                    solutionDiv.innerHTML = `<strong>‚ùå Error:</strong> ${data.error}`;
                } else {
                    solutionDiv.innerHTML = `<strong>‚ö†Ô∏è No solution found.</strong>`;
                }

                solutionDiv.className = 'solution show';

            } catch (err) {
                solutionDiv.innerHTML = '<strong>‚ùå Network Error:</strong> Unable to connect to the server. Please check if the system is running.';
                solutionDiv.className = 'solution show';
            } finally {
                // Reset button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }




            fetch(`/location/location_data?lat=${lat}&lon=${lon}`)
                .then(response => response.json())
                .then(data => {
                    const locationTableBody = document.querySelector('#locationTable tbody');
                    locationTableBody.innerHTML = '';
                    // Only show the unique nearest site by site_name
                    if (data.nearest_site && data.nearest_site.site_name) {
                        const nearest = data.nearest_site;
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td><b>${nearest.site_name} (Nearest)</b></td>
                            <td>${nearest.rsrp_range_1}</td>
                            <td>${nearest.rsrp_range_2}</td>
                            <td>${nearest.rsrp_range_3}</td>
                            <td>${nearest.rsrp_below_115}</td>
                            <td>${(nearest.distance_km / 1000).toFixed(2)} km</td>
                        `;
                        locationTableBody.appendChild(row);
                    } else {
                        const row = document.createElement('tr');
                        row.innerHTML = `<td colspan="6">No nearby site found.</td>`;
                        locationTableBody.appendChild(row);
                    }
                })
                .catch(error => console.error('Error fetching nearest site data:', error));



        });

        // Solutions UI Functions
        let selectedSolutions = new Set();
        let currentComplaintData = null;

        function showInlineSolutions(solutionData, complaintData) {
            currentComplaintData = complaintData;
            
            // Hide the old solution div if it has content
            const solutionDiv = document.getElementById('solution');
            if (solutionDiv.innerHTML.trim()) {
                solutionDiv.style.display = 'none';
            }
            
            // Show inline solutions container
            const inlineContainer = document.getElementById('inlineSolutionsContainer');
            inlineContainer.style.display = 'block';
            
            // Populate complaint details
            populateComplaintDetails(complaintData);
            
            // Populate solutions
            populateSolutions(solutionData);
            
            // Scroll to solutions
            inlineContainer.scrollIntoView({ behavior: 'smooth' });
        }

        function populateComplaintDetails(data) {
            const complaintMeta = document.getElementById('complaintMeta');
            const complaintDetails = document.getElementById('complaintDetails');
            
            const now = new Date();
            complaintMeta.innerHTML = `Case #CT${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}${Math.floor(Math.random() * 1000)} ‚Ä¢ Created on ${now.toLocaleDateString()}`;
            
            let detailsHTML = `
                <div class="detail-item">
                    <span class="detail-label">Main Issue:</span>
                    <span class="detail-value">${data.complaint || 'N/A'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Device Type:</span>
                    <span class="detail-value">${data.device_type_settings_vpn_apn || 'Not specified'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Signal Strength:</span>
                    <span class="detail-value">${data.signal_strength || 'Not specified'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Location Type:</span>
                    <span class="detail-value">${data.indoor_outdoor_coverage_issue || 'Not specified'}</span>
                </div>
            `;
            
            if (data.location) {
                detailsHTML += `
                    <div class="detail-item">
                        <span class="detail-label">Location:</span>
                        <span class="detail-value">${data.location}</span>
                    </div>
                `;
            }
            
            complaintDetails.innerHTML = detailsHTML;
        }

        function populateSolutions(solutionData) {
            const container = document.getElementById('solutionsContainer');
            let solutionsHTML = '';
            
            // Primary solution
            if (solutionData.primary) {
                solutionsHTML += createSolutionCard(solutionData.primary, 'primary', 'üîß', 'Primary Recommended Solution');
            }
            
            // Alternative solutions
            if (solutionData.alternatives && solutionData.alternatives.length > 0) {
                solutionData.alternatives.forEach((alt, index) => {
                    const icons = ['üí°', '‚öôÔ∏è', 'üìû'];
                    const titles = ['Alternative Solution 1', 'Alternative Solution 2', 'Alternative Solution 3'];
                    solutionsHTML += createSolutionCard(alt, 'alternate', icons[index] || '‚öôÔ∏è', titles[index] || `Alternative Solution ${index + 1}`);
                });
            }
            
            container.innerHTML = solutionsHTML;
        }

        function createSolutionCard(solution, cardClass, icon, defaultTitle) {
            const solutionId = `${cardClass}_${Math.random().toString(36).substr(2, 9)}`;
            const title = solution.title || defaultTitle;
            const description = solution.description || 'Please follow the recommended steps to resolve your connectivity issue.';
            const steps = solution.steps || [];
            
            let stepsHTML = '';
            if (steps.length > 0) {
                stepsHTML = `
                    <div class="solution-steps">
                        ${steps.map((step, index) => `
                            <div class="step-item">
                                <div class="step-number">${index + 1}</div>
                                <div class="step-text">${step}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            return `
                <div class="solution-card ${cardClass}">
                    <div class="solution-header">
                        <div class="solution-type">
                            <span class="solution-icon">${icon}</span>
                            <span class="solution-title">${title}</span>
                        </div>
                        <div class="checkbox-container">
                            <span class="checkbox-label">Mark as Applied</span>
                            <div class="solution-checkbox" onclick="toggleSolution(this, '${solutionId}', '${title}')"></div>
                        </div>
                    </div>
                    <div class="solution-content">
                        <p class="solution-description">${description}</p>
                        ${stepsHTML}
                    </div>
                </div>
            `;
        }

        function toggleSolution(checkboxElement, solutionId, solutionTitle) {
            const checkbox = checkboxElement;
            const isChecked = checkbox.classList.contains('checked');
            
            if (isChecked) {
                checkbox.classList.remove('checked');
                selectedSolutions.delete(solutionId);
            } else {
                checkbox.classList.add('checked');
                selectedSolutions.add(solutionId);
            }
            
            updateSelectedSolutionsList();
        }

        function updateSelectedSolutionsList() {
            const listElement = document.getElementById('selectedSolutionsList');
            
            if (selectedSolutions.size === 0) {
                listElement.innerHTML = '<li class="selected-item">No solutions selected yet</li>';
                return;
            }
            
            listElement.innerHTML = '';
            selectedSolutions.forEach(solutionId => {
                const listItem = document.createElement('li');
                listItem.className = 'selected-item';
                listItem.textContent = solutionId.includes('primary') ? 'Primary Recommended Solution' : 
                                     solutionId.includes('alternate') ? 'Alternative Solution' : solutionId;
                listElement.appendChild(listItem);
            });
        }

        function submitSolutions() {
            if (selectedSolutions.size === 0) {
                alert('Please select at least one solution before submitting.');
                return;
            }
            
            const solutionCount = selectedSolutions.size;
            alert(`Successfully submitted ${solutionCount} solution${solutionCount > 1 ? 's' : ''}! The technical team has been notified.`);
            
            // Here you would typically send the data to your backend
            console.log('Submitted solutions:', Array.from(selectedSolutions));
            console.log('Complaint data:', currentComplaintData);
        }

        function generateReport() {
            const solutions = Array.from(selectedSolutions);
            if (solutions.length === 0) {
                alert('Please select solutions to generate a report.');
                return;
            }
            
            alert('Solution report generated and downloaded!');
            // In a real application, this would generate a PDF or other report format
        }

        function resetSelections() {
            selectedSolutions.clear();
            document.querySelectorAll('.solution-checkbox').forEach(checkbox => {
                checkbox.classList.remove('checked');
            });
            updateSelectedSolutionsList();
            alert('All selections have been reset.');
        }

        // Initialize the selected solutions list when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateSelectedSolutionsList();
        });
    </script>
</body>

</html>